setwd("D:/R_asiaCCS2019")
library(data.tree)

CWE_category<- Node$new("CWE Category")
#Select the sub dataset
CWE17_tweets<-tweet_df[which(tweet_df$CWE=='CWE-17'),]
nrow(CWE17_tweets)

CWE17$tweets_number<-nrow(CWE17_tweets)
CWE17<-CWE_category$AddChild("CWE-17")


Soucecode18<-CWE17$AddChild("CWE-18")


CWE398<-Soucecode18$AddChild("CWE-398")   
#CWE-398 Indicator of Poor Code Quality 
#CWE-398 subtree

# CWE_category_398<- Node$new("CWE-398 Indicator of Poor Code Quality")
#   CWE404<-CWE_category_398$AddChild("CWE-404 Improper Resource Shutdown and Release")
#   CWE415<-CWE_category_398$AddChild("CWE-415 Double Free")
#   CWE416<-CWE_category_398$AddChild("CWE-416 Use After Free")
#   CWE476<-CWE_category_398$AddChild("CWE-476 NULL Pointer Dereference")
#   CWE399<-CWE_category_398$AddChild("CWE-399 Resource Management Errors")
#     CWE400<-CWE399$AddChild("CWE-400 Uncontrolled Resource Consumption ('Resource Exhaustion')")
#       CWE769<-CWE400$AddChild("CWE-769 File Descriptor Exhaustion")
#         CWE774<-CWE769$AddChild("CWE-774 Allocation of File Descriptors or Handles Without Limits or Throttling")
#         CWE775<-CWE769$AddChild("CWE-775 File Descriptor Exhaustion")
#     CWE404<-CWE399$AddChild("CWE-404 Improper Resource Shutdown and Release")
#     CWE405<-CWE399$AddChild("CWE-405 Asymmetric Resource Consumption (Amplification)")
#       CWE407<-CWE405$AddChild("CWE-407 Algorithmic Complexity")
#     CWE415<-CWE399$AddChild("CWE-415 Double Free")
#     CWE416<-CWE399$AddChild("CWE-416 Use After Free")
#     CWE417<-CWE399$AddChild("CWE-417 Channel and Path Errors")
#       CWE427<-CWE417$AddChild("CWE-427 Uncontrolled Search Path Element")
#       CWE428<-CWE417$AddChild("CWE-428 Unquoted Search Path or Element")
#       CWE426<-CWE417$AddChild("CWE-426 Untrusted Search Path")
# 
# print(CWE_category_398)


# full tree
# ctrl-shift-C

CWE404<-CWE398$AddChild("CWE-404")
CWE415<-CWE398$AddChild("CWE-415")
CWE416<-CWE398$AddChild("CWE-416")

CWE416_tweets<-tweet_df[which(tweet_df$CWE=='CWE-416'),]
nrow(CWE416_tweets)

CWE416$tweets_number<-nrow(CWE416_tweets)


CWE476<-CWE398$AddChild("CWE-476")
CWE399<-CWE398$AddChild("CWE-399")
CWE400<-CWE399$AddChild("CWE-400")
CWE769<-CWE400$AddChild("CWE-769")
CWE774<-CWE769$AddChild("CWE-774")
CWE775<-CWE769$AddChild("CWE-775")
CWE404<-CWE399$AddChild("CWE-404")
CWE405<-CWE399$AddChild("CWE-405")
CWE407<-CWE405$AddChild("CWE-407")
CWE415<-CWE399$AddChild("CWE-415")
CWE416<-CWE399$AddChild("CWE-416")
CWE417<-CWE399$AddChild("CWE-417")
CWE427<-CWE417$AddChild("CWE-427")
CWE428<-CWE417$AddChild("CWE-428")
CWE426<-CWE417$AddChild("CWE-426")


CWE485<-Soucecode18$AddChild("CWE-485")     

# CWE-485 Insufficient Encapsulation
# Subtree 

#   CWE_category_485<- Node$new("CWE-485 Insufficient Encapsulation")
#     CWE216<- CWE_category_485$AddChild("CWE-216 Containment Errors (Container Errors)")
#       CWE220<-CWE216$AddChild("CWE-220 Sensitive Data Under FTP Root")
#     CWE749<- CWE_category_485$AddChild("CWE-749 Exposed Dangerous Method or Function")
# print(CWE_category_485)
# plot(CWE_category_485)

CWE216<- CWE485$AddChild("CWE-216")
CWE220<-CWE216$AddChild("CWE-220")
CWE749<- CWE485$AddChild("CWE-749")


CWE19<-Soucecode18$AddChild("CWE-19")

#CWE-19 Data handling subtree
#CWE<-CWE$AddChild("CWE- ")
# CWE_category_19<-Node$new("CWE-19 Data Handling")
#   CWE116<- CWE_category_19$AddChild("CWE-116 Improper Encoding or Escaping of Output") 
#   CWE118<- CWE_category_19$AddChild("CWE-118 Improper Access of Indexable Resource ('Range Error')") 
#     CWE119<-CWE118$AddChild("CWE-119 Buffer Errors")
#       CWE123<-CWE119$AddChild("CWE-123 Write-What-Where Condition")
#       CWE125<-CWE119$AddChild("CWE-125 Out-of-bounds Read")
#       CWE787<-CWE119$AddChild("CWE-787 Out-of-bounds Write")
#       CWE824<-CWE119$AddChild("CWE-824 Access of Uninitialized Pointer")
#   CWE185<- CWE_category_19$AddChild("CWE-185 Incorrect Regular Expression") 
#   CWE20<- CWE_category_19$AddChild("CWE-20 Input Validation") 
#     CWE113<- CWE20$AddChild("CWE-113 Improper Neutralization of CRLF Sequences in HTTP Headers") 
#     CWE119<- CWE20$AddChild("CWE-119 Buffer Errors")
#       CWE123<-CWE119$AddChild("CWE-123 Write-What-Where Condition")
#       CWE125<-CWE119$AddChild("CWE-125 Out-of-bounds Read")
#       CWE787<-CWE119$AddChild("CWE-787 Out-of-bounds Write")
#       CWE824<-CWE119$AddChild("CWE-824 Access of Uninitialized Pointer")
#     CWE129<- CWE20$AddChild("CWE-129 Improer Validation of Array Index")
#     CWE134<- CWE20$AddChild("CWE-134 Format String Vulnerability")
#     CWE190<- CWE20$AddChild("CWE-190 Integer Overflow or Wraparound")
#     CWE601<- CWE20$AddChild("CWE-601 URL Redirection to Untrusted")
#     CWE74<- CWE20$AddChild("CWE-74 Injection")
#       CWE134<-CWE74$AddChild("CWE-134 Format String Vulnerability")
#       CWE77<-CWE74$AddChild("CWE-77 Command Injection")
#         CWE78<-CWE77$AddChild("CWE-78 OS Command Injections")
#         CWE88<-CWE77$AddChild("CWE-88 Argument Injection or Modification")
#       CWE79<-CWE74$AddChild("CWE-79 Cross-Site Scripting (XSS)")
#       CWE91<-CWE74$AddChild("CWE-91 XML Injection (aka Blind XPath Injection)")
#       CWE93<-CWE74$AddChild("CWE-93 Improper Neutralization of CRLF Sequences ('CRLF Injection')")
#         CWE113<-CWE93$AddChild("CWE-113 CWE-113 Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting')")
#       CWE94<-CWE74$AddChild("CWE-94 Code Injection")
#       CWE943<-CWE74$AddChild("CWE-943 Improper Neutralization of Special Elements in Data Query Logic")
#         CWE89<-CWE943$AddChild("CWE-89 SQL Injection")
#         CWE90<-CWE943$AddChild("CWE-90 Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')")
#       CWE99<-CWE74$AddChild("CWE-99 Improper Control of Resource Identifiers ('Resource Injection') ")
#         CWE694<-CWE99$AddChild("CWE-694 Use of Multiple Resources with Duplicate Identifier")
#     CWE77<- CWE20$AddChild("CWE-77 Command Injection")
#       CWE78<-CWE77$AddChild("CWE-78 OS Command Injections")
#       CWE88<-CWE77$AddChild("CWE-88 Argument Injection or Modification")
#     CWE79<- CWE20$AddChild("CWE-79 Cross-site Scripting (XSS)")
#     CWE89<- CWE20$AddChild("CWE-89 SQL Injection")
#     CWE99<- CWE20$AddChild("CWE-99 Improper Control of Resource Identifiers ('Resource Injection')")
#       CWE694<-CWE99$AddChild("CWE-694 Use of Multiple Resources with Duplicate Identifier")
#     CWE21<- CWE20$AddChild("CWE-21 Path Equivalence")
#       CWE22<-CWE21$AddChild("CWE-22 Path Traversal")
#       CWE59<-CWE21$AddChild("CWE-59 Link Following")
#   CWE471<- CWE_category_19$AddChild("CWE-471 Modification of Assumed-Immutable Data (MAID)") 
#     CWE472<- CWE471$AddChild("CWE-472 External Control of Assumed Immutable Web Parameter")
#   CWE137<- CWE_category_19$AddChild("CWE-137 Representation Errors") 
#     CWE171<- CWE137$AddChild("CWE-171 Cleansing, Canonicalization, and Comparison Errors")
#       CWE172<-CWE171$AddChild("CWE-172 Encoding Error")
#       CWE184<-CWE171$AddChild("CWE-184 Incomplete Blacklist")
#       CWE185<-CWE171$AddChild("CWE-185 Incorrect Regular Expression")
#       CWE707<-CWE171$AddChild("CWE-707 Improper Enforcement of Message or Data Structure")
#         CWE116<-CWE707$AddChild("CWE-116 Improper Encoding or Escaping of Output")
#         CWE172<-CWE707$AddChild("CWE-172 Encoding Error")
#         CWE74<-CWE707$AddChild("CWE-74 Injection")
#          CWE134<-CWE74$AddChild("CWE-134 Format String Vulnerability")
#          CWE77<-CWE74$AddChild("CWE-77 Command Injection")
#             CWE78<-CWE77$AddChild("CWE-78 OS Command Injections")
#             CWE88<-CWE77$AddChild("CWE-88 Argument Injection or Modification")
#          CWE79<-CWE74$AddChild("CWE-79 Cross-Site Scripting (XSS)")
#          CWE91<-CWE74$AddChild("CWE-91 XML Injection (aka Blind XPath Injection)")
#          CWE93<-CWE74$AddChild("CWE-93 Improper Neutralization of CRLF Sequences ('CRLF Injection')")
#            CWE113<-CWE93$AddChild("CWE-113 CWE-113 Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting')")
#          CWE94<-CWE74$AddChild("CWE-94 Code Injection")
#          CWE943<-CWE74$AddChild("CWE-943 Improper Neutralization of Special Elements in Data Query Logic")
#            CWE89<-CWE943$AddChild("CWE-89 SQL Injection")
#            CWE90<-CWE943$AddChild("CWE-90 Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')")
#          CWE99<-CWE74$AddChild("CWE-99 Improper Control of Resource Identifiers ('Resource Injection') ")
#            CWE694<-CWE99$AddChild("CWE-694 Use of Multiple Resources with Duplicate Identifier")
#   CWE189<- CWE_category_19$AddChild("CWE-189 Numeric Errors") 
#     CWE129<- CWE189$AddChild("CWE-129 Improer Validation of Array Index")
#     CWE190<- CWE189$AddChild("CWE-190 Integer Overflow or Wraparound")
#     CWE682<- CWE189$AddChild("CWE-682 Incorrect Calculation")
#       CWE190<-CWE682$AddChild("CWE-190 Integer Overflow or Wraparound")
#       CWE191<-CWE682$AddChild("CWE-191 Integer Underflow (Wrap or Wraparound)")
#       CWE369<-CWE682$AddChild("CWE-369 Divide By Zero")
#   CWE199<- CWE_category_19$AddChild("CWE-199 Information Management Errors") 
#     CWE200<- CWE199$AddChild("CWE-200 Information Leak/Disclosure") 
#       CWE538<-CWE200$AddChild("CWE-538 File and Directory Information Exposure")
#         CWE532<-CWE538$AddChild("CWE-532 Information Exposure Through Log Files")
#           CWE534<-CWE532$AddChild("CWE-534 Information Exposure Through Debug Log Files")
#     CWE216<- CWE199$AddChild("CWE-216 Containment Errors (Container Errors)") 
#       CWE220<-CWE216$AddChild("CWE-220 Sensitive Data Under FTP Root")
#     print(CWE_category_19)


CWE116<- CWE19$AddChild("CWE-116") 
CWE118<- CWE19$AddChild("CWE-118") 
CWE119<-CWE118$AddChild("CWE-119")

#Select the sub dataset
CWE119_tweets<-tweet_df[which(tweet_df$CWE=='CWE-119'),]
nrow(CWE119_tweets)

CWE119$tweets_number<-nrow(CWE119_tweets)

CWE123<-CWE119$AddChild("CWE-123")
CWE125<-CWE119$AddChild("CWE-125")
CWE787<-CWE119$AddChild("CWE-787")
CWE824<-CWE119$AddChild("CWE-824")
CWE185<- CWE19$AddChild("CWE-185") 
CWE20<- CWE19$AddChild("CWE-20") 


CWE20_tweets<-tweet_df[which(tweet_df$CWE=='CWE-20'),]
nrow(CWE20_tweets)

CWE20$tweets_number<-nrow(CWE20_tweets)
CWE113<- CWE20$AddChild("CWE-113") 
CWE119<- CWE20$AddChild("CWE-119")
CWE123<-CWE119$AddChild("CWE-123")
CWE125<-CWE119$AddChild("CWE-125")
CWE787<-CWE119$AddChild("CWE-787")
CWE824<-CWE119$AddChild("CWE-824")
CWE129<- CWE20$AddChild("CWE-129")
CWE134<- CWE20$AddChild("CWE-134")
CWE190<- CWE20$AddChild("CWE-190")
CWE601<- CWE20$AddChild("CWE-601")
CWE74<- CWE20$AddChild("CWE-74")
CWE134<-CWE74$AddChild("CWE-134")
CWE77<-CWE74$AddChild("CWE-77")
CWE78<-CWE77$AddChild("CWE-78")
CWE88<-CWE77$AddChild("CWE-88")
CWE79<-CWE74$AddChild("CWE-79")
CWE91<-CWE74$AddChild("CWE-91")
CWE93<-CWE74$AddChild("CWE-93")
CWE113<-CWE93$AddChild("CWE-113")
CWE94<-CWE74$AddChild("CWE-94")



CWE94_tweets<-tweet_df[which(tweet_df$CWE=='CWE-94'),]
nrow(CWE94_tweets)

CWE94$tweets_number<-nrow(CWE94_tweets)

CWE943<-CWE74$AddChild("CWE-943")
CWE89<-CWE943$AddChild("CWE-89")

CWE89_tweets<-tweet_df[which(tweet_df$CWE=='CWE-89'),]
nrow(CWE89_tweets)

CWE89$tweets_number<-nrow(CWE89_tweets)

CWE90<-CWE943$AddChild("CWE-90")
CWE99<-CWE74$AddChild("CWE-99")
CWE694<-CWE99$AddChild("CWE-694")
CWE77<- CWE20$AddChild("CWE-77")
CWE78<-CWE77$AddChild("CWE-78")

#Select the sub dataset
CWE78_tweets<-tweet_df[which(tweet_df$CWE=='CWE-78'),]
nrow(CWE78_tweets)

CWE78$tweets_number<-nrow(CWE78_tweets)

CWE88<-CWE77$AddChild("CWE-88")
CWE79<- CWE20$AddChild("CWE-79")
CWE89<- CWE20$AddChild("CWE-89")
CWE99<- CWE20$AddChild("CWE-99")
CWE694<-CWE99$AddChild("CWE-694")
CWE21<- CWE20$AddChild("CWE-21")
CWE22<-CWE21$AddChild("CWE-22")
CWE59<-CWE21$AddChild("CWE-59")
CWE471<- CWE19$AddChild("CWE-471") 
CWE472<- CWE471$AddChild("CWE-472")
CWE137<- CWE19$AddChild("CWE-137") 
CWE171<- CWE137$AddChild("CWE-171")
CWE172<-CWE171$AddChild("CWE-172")
CWE184<-CWE171$AddChild("CWE-184")
CWE185<-CWE171$AddChild("CWE-185")
CWE707<-CWE171$AddChild("CWE-707")
CWE116<-CWE707$AddChild("CWE-116")
CWE172<-CWE707$AddChild("CWE-172")
CWE74<-CWE707$AddChild("CWE-74")
CWE134<-CWE74$AddChild("CWE-134")
CWE77<-CWE74$AddChild("CWE-77")
CWE78<-CWE77$AddChild("CWE-78")
CWE88<-CWE77$AddChild("CWE-88")
CWE79<-CWE74$AddChild("CWE-79")
CWE91<-CWE74$AddChild("CWE-91")
CWE93<-CWE74$AddChild("CWE-93")
CWE113<-CWE93$AddChild("CWE-113")
CWE94<-CWE74$AddChild("CWE-94")
CWE943<-CWE74$AddChild("CWE-943")
CWE89<-CWE943$AddChild("CWE-89")
CWE90<-CWE943$AddChild("CWE-90")
CWE99<-CWE74$AddChild("CWE-99")
CWE694<-CWE99$AddChild("CWE-694")
CWE189<- CWE19$AddChild("CWE-189") 
CWE129<- CWE189$AddChild("CWE-129")
CWE190<- CWE189$AddChild("CWE-190")
CWE682<- CWE189$AddChild("CWE-682")
CWE190<-CWE682$AddChild("CWE-190")
CWE191<-CWE682$AddChild("CWE-191")
CWE369<-CWE682$AddChild("CWE-369")
CWE199<- CWE19$AddChild("CWE-199") 
CWE200<- CWE199$AddChild("CWE-200") 
CWE538<-CWE200$AddChild("CWE-538")
CWE532<-CWE538$AddChild("CWE-532")
CWE534<-CWE532$AddChild("CWE-534")
CWE216<- CWE199$AddChild("CWE-216") 
CWE220<-CWE216$AddChild("CWE-220")



CWE254<-Soucecode18$AddChild("CWE-254")


# CWE-254 Security features
#CWE<-CWE$AddChild("CWE-")
# CWE_category_254<-Node$new("CWE-254 Security features")
# CWE285<-CWE_category_254$AddChild("CWE-285 Improper Authorization")
# CWE287<-CWE_category_254$AddChild("CWE-287 Authentication Issues")
#   CWE306<-CWE287$AddChild("CWE-306 Missing Authentication for Critical Function")
#   CWE640<-CWE287$AddChild("CWE-640 Weak Password Recovery Mechanism for Forgotten Password")
#   CWE798<-CWE287$AddChild("CWE-798 Use of Hard-coded Credentials")
#   CWE384<-CWE287$AddChild("CWE-384 Session Fixation")
# CWE295<-CWE_category_254$AddChild("CWE-295 Improper Certificate Validation")
#  CWE297<-CWE295$AddChild("CWE-297 Improper Validation of Certificate with Host Mismatch")
# CWE330<-CWE_category_254$AddChild("CWE-330 Use of Insufficiency Random Values")
#  CWE331<-CWE330$AddChild("CWE-331 Insufficient Entropy")
#    CWE332<-CWE331$AddChild("CWE-332 Insufficient Entropy in PRNG")
#  CWE338<-CWE330$AddChild("CWE-338 Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)")
# CWE345<-CWE_category_254$AddChild("CWE-345 Insufficient Verification of Data Authenticity")
#   CWE346<-CWE345$AddChild("CWE-346 Origin Validation Error")
#   CWE347<-CWE345$AddChild("CWE-347 Improper Verification of Cryptographic Signature")
#   CWE352<-CWE345$AddChild("CWE-352 Cross-Site Request Forgery (CSRF)")
# CWE358<-CWE_category_254$AddChild("CWE-358 Improperly Implemented Security Check for Standard")
# CWE693<-CWE_category_254$AddChild("CWE-693 Protection Mechanism Failure")
#   CWE184<-CWE693$AddChild("CWE-184 Imcomplete Blacklist")
#   CWE20<-CWE693$AddChild("CWE-20 Input Validation")
#     CWE113<-CWE20$AddChild("CWE-113 Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting')")
#     CWE119<-CWE20$AddChild("CWE-119 Buffer Errors")
#       CWE123<-CWE119$AddChild("CWE-123 Write-What-Where Condition")
#       CWE125<-CWE119$AddChild("CWE-125 Out-of-bounds Read")
#       CWE787<-CWE119$AddChild("CWE-787 Out-of-bounds Write")
#       CWE824<-CWE119$AddChild("CWE-824 Access of Uninitialized Pointer")
#     CWE129<-CWE20$AddChild("CWE-129 Improer Validation of Array Index")
#     CWE134<-CWE20$AddChild("CWE-134 Format String Vulnerability")
#     CWE190<-CWE20$AddChild("CWE-190 Integer Overflow or Wraparound")
#     CWE601<-CWE20$AddChild("CWE-601 URL Redirection to Untrusted")
#     CWE74<-CWE20$AddChild("CWE-74 Injection")
#       CWE134<-CWE74$AddChild("CWE-134 Format String Vulnerability")
#       CWE77<-CWE74$AddChild("CWE-77 Command Injection")
#        CWE78<-CWE77$AddChild("CWE-78 OS Command Injections")
#        CWE88<-CWE77$AddChild("CWE-88 Argument Injection or Modification")
#       CWE79<-CWE74$AddChild("CWE-79 Cross-Site Scripting (XSS)")
#       CWE91<-CWE74$AddChild("CWE-91 XML Injection (aka Blind XPath Injection)")
#       CWE93<-CWE74$AddChild("CWE-93 Improper Neutralization of CRLF Sequences ('CRLF Injection')")
#        CWE113<-CWE93$AddChild("CWE-113 CWE-113 Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting')")
#       CWE94<-CWE74$AddChild("CWE-94 Code Injection")
#       CWE943<-CWE74$AddChild("CWE-943 Improper Neutralization of Special Elements in Data Query Logic")
#        CWE89<-CWE943$AddChild("CWE-89 SQL Injection")
#        CWE90<-CWE943$AddChild("CWE-90 Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')")
#       CWE99<-CWE74$AddChild("CWE-99 Improper Control of Resource Identifiers ('Resource Injection') ")
#        CWE694<-CWE99$AddChild("CWE-694 Use of Multiple Resources with Duplicate Identifier")
#     CWE77<-CWE20$AddChild("CWE-77 Command Injection")
#       CWE78<-CWE77$AddChild("CWE-78 OS Command Injections")
#       CWE88<-CWE77$AddChild("CWE-88 Argument Injection or Modification")
#     CWE79<-CWE20$AddChild("CWE-79 Cross-Site Scripting (XSS)")
#     CWE89<-CWE20$AddChild("CWE-89 SQL Injection")
#     CWE99<-CWE20$AddChild("CWE-99 Improper Control of Resource Identifiers ('Resource Injection')")
#      CWE694<-CWE99$AddChild("CWE-694 Use of Multiple Resources with Duplicate Identifier")
#     CWE21<-CWE20$AddChild("CWE-21 Path Equivalence")
#       CWE22<-CWE21$AddChild("CWE-22 Path Traversal")
#       CWE59<-CWE21$AddChild("CWE-59 Link Following")
#   CWE284<-CWE693$AddChild("CWE-284 Improper Access Control")
#     CWE285<-CWE284$AddChild("CWE-285 Improper Authorization")
#     CWE287<-CWE284$AddChild("CWE-287 Authentication Issues")
#       CWE306<-CWE287$AddChild("CWE-306 Missing Authentication for Critical Function")
#       CWE640<-CWE287$AddChild("CWE-640 Weak Password Recovery Mechanism for Forgotten Password")
#       CWE798<-CWE287$AddChild("CWE-798 Use of Hard-coded Credentials")
#       CWE384<-CWE287$AddChild("CWE-384 Session Fixation")
#     CWE346<-CWE284$AddChild("CWE-346 Origin Validation Error")
#   CWE295<-CWE693$AddChild("CWE-295 Improper Certificate Validation")
#    CWE297<-CWE295$AddChild("CWE-297 Improper Validation of Certificate with Host Mismatch")
#   CWE326<-CWE693$AddChild("CWE-326 Inadequate Encryption Strength")
#   CWE327<-CWE693$AddChild("CWE-327 Use of a Broken or Risky Cryptographic Algorithm")
#   CWE345<-CWE693$AddChild("CWE-345 Insufficient Verification of Data Authenticity")
#     CWE346<-CWE345$AddChild("CWE-346 Origin Validation Error")
#     CWE347<-CWE345$AddChild("CWE-347 Improper Verification of Cryptographic Signature")
#     CWE352<-CWE345$AddChild("CWE-352 Cross-Site Request Forgery (CSRF)")
#   CWE358<-CWE693$AddChild("CWE-358 Improperly Implemented Security Check for Standard")
# CWE798<-CWE_category_254$AddChild("CWE-798 Use of Hard-coded Credentials")
# CWE255<-CWE_category_254$AddChild("CWE-255 Credentials Management")
#   CWE640<-CWE255$AddChild("CWE-640 Weak Password Recovery Mechanism for Forgotten Password")
#   CWE798<-CWE255$AddChild("CWE-798 Use of Hard-coded Credentials")
# CWE264<-CWE_category_254$AddChild("CWE-264 Permissions, Privileges, and Access Control")
#   CWE284<-CWE264$AddChild("CWE-284 Improper Access Control")
#     CWE285<-CWE284$AddChild("CWE-285 Improper Authorization")
#     CWE287<-CWE284$AddChild("CWE-287 Authentication Issues")
#       CWE306<-CWE287$AddChild("CWE-306 Missing Authentication for Critical Function")
#       CWE640<-CWE287$AddChild("CWE-640 Weak Password Recovery Mechanism for Forgotten Password")
#       CWE798<-CWE287$AddChild("CWE-798 Use of Hard-coded Credentials")
#       CWE384<-CWE287$AddChild("CWE-384 Session Fixation")
#     CWE346<-CWE284$AddChild("CWE-346 Origin Validation Error")
#   CWE275<-CWE264$AddChild("CWE-275 Permission Issues")
# CWE310<-CWE_category_254$AddChild("CWE-310 Cryptographic Issues")
#   CWE326<-CWE310$AddChild("CWE-326 Inadequate Encryption Strength")
#   CWE327<-CWE310$AddChild("CWE-327 Use of a Broken or Risky Cryptographic Algorithm")
#   CWE320<-CWE310$AddChild("CWE-320 Key Management Errors")

#print(CWE_category_254)


CWE285<-CWE254$AddChild("CWE-28")
CWE287<-CWE254$AddChild("CWE-287")
CWE306<-CWE287$AddChild("CWE-306")
CWE640<-CWE287$AddChild("CWE-640")
CWE798<-CWE287$AddChild("CWE-798")
CWE384<-CWE287$AddChild("CWE-384")
CWE295<-CWE254$AddChild("CWE-295")
CWE297<-CWE295$AddChild("CWE-297")
CWE330<-CWE254$AddChild("CWE-330")
CWE331<-CWE330$AddChild("CWE-331")
CWE332<-CWE331$AddChild("CWE-332")
CWE338<-CWE330$AddChild("CWE-338")
CWE345<-CWE254$AddChild("CWE-345")
CWE346<-CWE345$AddChild("CWE-346")
CWE347<-CWE345$AddChild("CWE-347")
CWE352<-CWE345$AddChild("CWE-352")
CWE358<-CWE254$AddChild("CWE-358")
CWE693<-CWE254$AddChild("CWE-693")
CWE184<-CWE693$AddChild("CWE-184")
CWE20<-CWE693$AddChild("CWE-20")
CWE113<-CWE20$AddChild("CWE-113")
CWE119<-CWE20$AddChild("CWE-119")
CWE123<-CWE119$AddChild("CWE-123")
CWE125<-CWE119$AddChild("CWE-125")
CWE787<-CWE119$AddChild("CWE-787")
CWE824<-CWE119$AddChild("CWE-824")
CWE129<-CWE20$AddChild("CWE-129")
CWE134<-CWE20$AddChild("CWE-134")
CWE190<-CWE20$AddChild("CWE-190")
CWE601<-CWE20$AddChild("CWE-601")
CWE74<-CWE20$AddChild("CWE-74")
CWE134<-CWE74$AddChild("CWE-134")
CWE77<-CWE74$AddChild("CWE-77")
CWE78<-CWE77$AddChild("CWE-78")
CWE88<-CWE77$AddChild("CWE-88")
CWE79<-CWE74$AddChild("CWE-79")
CWE91<-CWE74$AddChild("CWE-91")
CWE93<-CWE74$AddChild("CWE-93")
CWE113<-CWE93$AddChild("CWE-113")
CWE94<-CWE74$AddChild("CWE-94")
CWE943<-CWE74$AddChild("CWE-943")
CWE89<-CWE943$AddChild("CWE-89")
CWE90<-CWE943$AddChild("CWE-90")
CWE99<-CWE74$AddChild("CWE-99")
CWE694<-CWE99$AddChild("CWE-69")
CWE77<-CWE20$AddChild("CWE-77")
CWE78<-CWE77$AddChild("CWE-78")
CWE88<-CWE77$AddChild("CWE-88")
CWE79<-CWE20$AddChild("CWE-79")
CWE89<-CWE20$AddChild("CWE-89")
CWE99<-CWE20$AddChild("CWE-99")
CWE694<-CWE99$AddChild("CWE-694")
CWE21<-CWE20$AddChild("CWE-21")
CWE22<-CWE21$AddChild("CWE-22")
CWE59<-CWE21$AddChild("CWE-59")
CWE284<-CWE693$AddChild("CWE-284")
CWE285<-CWE284$AddChild("CWE-285")
CWE287<-CWE284$AddChild("CWE-287")
CWE306<-CWE287$AddChild("CWE-306")
CWE640<-CWE287$AddChild("CWE-640")
CWE798<-CWE287$AddChild("CWE-798")
CWE384<-CWE287$AddChild("CWE-384")
CWE346<-CWE284$AddChild("CWE-346")
CWE295<-CWE693$AddChild("CWE-295")
CWE297<-CWE295$AddChild("CWE-297")
CWE326<-CWE693$AddChild("CWE-326")
CWE327<-CWE693$AddChild("CWE-327")
CWE345<-CWE693$AddChild("CWE-345")
CWE346<-CWE345$AddChild("CWE-346")
CWE347<-CWE345$AddChild("CWE-347")
CWE352<-CWE345$AddChild("CWE-352")
CWE358<-CWE693$AddChild("CWE-358")
CWE798<-CWE254$AddChild("CWE-798")
CWE255<-CWE254$AddChild("CWE-255")
CWE640<-CWE255$AddChild("CWE-640")
CWE798<-CWE255$AddChild("CWE-798")
CWE264<-CWE254$AddChild("CWE-264")
CWE284<-CWE264$AddChild("CWE-284")
CWE285<-CWE284$AddChild("CWE-285")
CWE287<-CWE284$AddChild("CWE-287")
CWE306<-CWE287$AddChild("CWE-306")
CWE640<-CWE287$AddChild("CWE-640")
CWE798<-CWE287$AddChild("CWE-798")
CWE384<-CWE287$AddChild("CWE-384")
CWE346<-CWE284$AddChild("CWE-346")
CWE275<-CWE264$AddChild("CWE-275")
CWE310<-CWE254$AddChild("CWE-310")
CWE326<-CWE310$AddChild("CWE-326")
CWE327<-CWE310$AddChild("CWE-327")
CWE320<-CWE310$AddChild("CWE-320")



CWE361<-Soucecode18$AddChild("CWE-361")
#  CWE361 Time and State
#CWE<-CWE$AddChild("CWE-")
# CWE_category_361<-Node$new("CWE-361 Time and State")
#  CWE362<-CWE_category_361$AddChild("CWE-362 Race conditions")
#  CWE613<-CWE_category_361$AddChild("CWE-613 Insufficient Session Expiration")
#  CWE664<-CWE_category_361$AddChild("CWE-664 Improper Control of a Resource Through its Lifetime")
#    CWE284<-CWE664$AddChild("CWE-284 Improper Access Control")
#      CWE285<-CWE284$AddChild("CWE-285 Improper Authorization")
#      CWE287<-CWE284$AddChild("CWE-287 Authentication Issues")
#         CWE306<-CWE287$AddChild("CWE-306 Missing Authentication for Critical Function")
#         CWE640<-CWE287$AddChild("CWE-640 Weak Password Recovery Mechanism for Forgotten Password")
#         CWE798<-CWE287$AddChild("CWE-798 Use of Hard-coded Credentials")
#         CWE384<-CWE287$AddChild("CWE-384 Session Fixation")
#      CWE346<-CWE284$AddChild("CWE-346 Origin Validation Error")
#    CWE400<-CWE664$AddChild("CWE-400 Uncontrolled Resource Consumption ('Resource Exhaustion')")
#      CWE769<-CWE400$AddChild("CWE-769 File Descriptor Exhaustion")
#         CWE774<-CWE769$AddChild("CWE-774 Allocation of File Descriptors or Handles Without Limits or Throttling")
#         CWE775<-CWE769$AddChild("CWE-775 File Descriptor Exhaustion")
#    CWE404<-CWE664$AddChild("CWE-404 Improper Resource Shutdown and Release")
#    CWE405<-CWE664$AddChild("CWE-405 Asymmetric Resource Consumption (Amplification)")
#     CWE407<-CWE405$AddChild("CWE-407 Algorithmic Complexity")
#    CWE471<-CWE664$AddChild("CWE-471 Modification of Assumed-Immutable Data (MAID)")
#     CWE472<-CWE471$AddChild("CWE-472 External Control of Assumed Immutable Web Parameter")
#    CWE485<-CWE664$AddChild("CWE-485 Insufficient Encapsulation")
#      CWE216<-CWE485$AddChild("CWE-216 Containment Errors (Container Errors)")
#         CWE220<-CWE216$AddChild("CWE-220 Sensitive Data Under FTP Root")
#      CWE749<-CWE485$AddChild("CWE-749 Exposed Dangerous Method or Function")
#    CWE610<-CWE664$AddChild("CWE-610 Externally Controlled Reference to a Resource in Another Sphere")
# 
#      CWE441<-CWE610$AddChild("CWE-441 Unintended Proxy or Intermediary ('Confused Deputy')")
#       CWE918<-CWE441$AddChild("CWE-918 Server-Side Request Forgery (SSRF)")
#      CWE601<-CWE610$AddChild("CWE-601 URL Redirection to Untrusted")
#      CWE611<-CWE610$AddChild("CWE-611 Improper Restriction of XML External Entity Reference ('XXE')")
#    CWE665<-CWE664$AddChild("CWE-665 Improper Initialization")
#    CWE668<-CWE664$AddChild("CWE-668 Exposure of Resource to Wrong Sphere")
#     CWE200<-CWE668$AddChild("CWE-200 Information Leak/Disclosure")
#       CWE538<-CWE200$AddChild("CWE-538 File and Directory Information Exposure")
#         CWE532<-CWE538$AddChild("CWE-532 Information Exposure Through Log Files")
#           CWE534<-CWE532$AddChild("CWE-534 Information Exposure Through Debug Log Files")
#     CWE220<-CWE668$AddChild("CWE-220 Sensitive Data Under FTP Root")
#      CWE22<-CWE668$AddChild("CWE-22 Path Traversal")
#      CWE427<-CWE668$AddChild("CWE-427 Uncontrolled Search Path Element")
#      CWE428<-CWE668$AddChild("CWE-428 Unquoted Search Path or Element")
#      CWE552<-CWE668$AddChild("CWE-552 Files or Directories Accessible to External Parties")
#         CWE532<-CWE552$AddChild("CWE-532 Information Exposure Through Log Files")
#           CWE534<-CWE532$AddChild("CWE-534 Information Exposure Through Debug Log Files")
#         CWE534<-CWE552$AddChild("CWE-534 Information Exposure Through Debug Log Files")
#      CWE642<-CWE668$AddChild("CWE-642 External Control of Critical State Data")
#       CWE472<-CWE642$AddChild("CWE-472 External Control of Assumed Immutable Web Parameter")
#       CWE426<-CWE642$AddChild("CWE-426 Untrusted Search Path")
# 
# 
# 
#    CWE669<-CWE664$AddChild("CWE-669 Incorrect Resource Transfer Between Sphere")
#      CWE434<-CWE669$AddChild("CWE-434 Unrestricted Upload of File with Dangerous Type")
#    CWE704<-CWE664$AddChild("CWE-704 Incorrect Type Conversion or Cast")
#    CWE913<-CWE664$AddChild("CWE-913 Improper Control of Dynamically-Managed Code Resources")
#      CWE502<-CWE913$AddChild("CWE-502 Deserialization of Untrusted Data")
#      CWE94<-CWE913$AddChild("CWE-94 Code Injection")
#  CWE668<-CWE_category_361$AddChild("CWE-668 Exposure of Resource to Wrong Sphere")
#    CWE200<-CWE668$AddChild("CWE-200 Information Leak/Disclosure")
#     CWE538<-CWE200$AddChild("CWE-538 File and Directory Information Exposure")
#       CWE532<-CWE538$AddChild("CWE-532 Information Exposure Through Log Files")
#         CWE534<-CWE532$AddChild("CWE-534 Information Exposure Through Debug Log Files")
# 
#    CWE22<-CWE668$AddChild("CWE-22 Path Traversal")
#    CWE220<-CWE668$AddChild("CWE-220 Sensitive Data Under FTP Root")
#    CWE427<-CWE668$AddChild("CWE-427 Uncontrolled Search Path Element")
#    CWE428<-CWE668$AddChild("CWE-428 Unquoted Search Path or Element")
#    CWE552<-CWE668$AddChild("CWE-552 Files or Directories Accessible to External Parties")
#       CWE532<-CWE552$AddChild("CWE-532 Information Exposure Through Log Files")
#       CWE534<-CWE532$AddChild("CWE-534 Information Exposure Through Debug Log Files")
#      CWE534<-CWE552$AddChild("CWE-534 Information Exposure Through Debug Log Files")
#    CWE642<-CWE668$AddChild("CWE-642 External Control of Critical State Data")
#      CWE472<-CWE642$AddChild("CWE-472 External Control of Assumed Immutable Web Parameter")
#      CWE426<-CWE642$AddChild("CWE-426 Untrusted Search Path")
#  CWE669<-CWE_category_361$AddChild("CWE-669 Incorrect Resource Transfer Between Spheres")
#    CWE434<-CWE669$AddChild("CWE-434 Unrestricted Upload of File with Dangerous Type")
#  CWE371<-CWE_category_361$AddChild("CWE-371 State Issues")
#    CWE472<-CWE371$AddChild("CWE-472 External Control of Assumed Immutable Web Parameter")
#    CWE642<-CWE371$AddChild("CWE-642 External Control of Critical State Data")
#      CWE472<-CWE642$AddChild("CWE-472 External Control of Assumed Immutable Web Parameter")
#      CWE426<-CWE642$AddChild("CWE-426 Untrusted Search Path")
#  CWE384<-CWE_category_361$AddChild("CWE-384 Session Fixation")
# print(CWE_category_361)



CWE362<-CWE361$AddChild("CWE-362")
CWE613<-CWE361$AddChild("CWE-613")
CWE664<-CWE361$AddChild("CWE-664")
CWE284<-CWE664$AddChild("CWE-284")
CWE285<-CWE284$AddChild("CWE-285")
CWE287<-CWE284$AddChild("CWE-287")
CWE306<-CWE287$AddChild("CWE-306")
CWE640<-CWE287$AddChild("CWE-640")
CWE798<-CWE287$AddChild("CWE-798")
CWE384<-CWE287$AddChild("CWE-384")
CWE346<-CWE284$AddChild("CWE-346")
CWE400<-CWE664$AddChild("CWE-400")
CWE769<-CWE400$AddChild("CWE-769")
CWE774<-CWE769$AddChild("CWE-774")
CWE775<-CWE769$AddChild("CWE-775")
CWE404<-CWE664$AddChild("CWE-404")
CWE405<-CWE664$AddChild("CWE-405")
CWE407<-CWE405$AddChild("CWE-407")
CWE471<-CWE664$AddChild("CWE-471")
CWE472<-CWE471$AddChild("CWE-472")
CWE485<-CWE664$AddChild("CWE-485")
CWE216<-CWE485$AddChild("CWE-216")
CWE220<-CWE216$AddChild("CWE-220")
CWE749<-CWE485$AddChild("CWE-749")
CWE610<-CWE664$AddChild("CWE-610")

CWE441<-CWE610$AddChild("CWE-441")
CWE918<-CWE441$AddChild("CWE-918")
CWE601<-CWE610$AddChild("CWE-601")
CWE611<-CWE610$AddChild("CWE-611")
CWE665<-CWE664$AddChild("CWE-665")
CWE668<-CWE664$AddChild("CWE-668")
CWE200<-CWE668$AddChild("CWE-200")
CWE538<-CWE200$AddChild("CWE-538")
CWE532<-CWE538$AddChild("CWE-532")
CWE534<-CWE532$AddChild("CWE-534")
CWE220<-CWE668$AddChild("CWE-220")
CWE22<-CWE668$AddChild("CWE-22")
CWE427<-CWE668$AddChild("CWE-427")
CWE428<-CWE668$AddChild("CWE-428")
CWE552<-CWE668$AddChild("CWE-552")
CWE532<-CWE552$AddChild("CWE-532")
CWE534<-CWE532$AddChild("CWE-534")
CWE534<-CWE552$AddChild("CWE-534")
CWE642<-CWE668$AddChild("CWE-642")
CWE472<-CWE642$AddChild("CWE-472")
CWE426<-CWE642$AddChild("CWE-426")



CWE669<-CWE664$AddChild("CWE-669")
CWE434<-CWE669$AddChild("CWE-434")
CWE704<-CWE664$AddChild("CWE-704")
CWE913<-CWE664$AddChild("CWE-913")
CWE502<-CWE913$AddChild("CWE-502")
CWE94<-CWE913$AddChild("CWE-94")
CWE668<-CWE361$AddChild("CWE-668")
CWE200<-CWE668$AddChild("CWE-200")
CWE538<-CWE200$AddChild("CWE-538")
CWE532<-CWE538$AddChild("CWE-532")
CWE534<-CWE532$AddChild("CWE-534")

CWE22<-CWE668$AddChild("CWE-22")
CWE220<-CWE668$AddChild("CWE-220")
CWE427<-CWE668$AddChild("CWE-427")
CWE428<-CWE668$AddChild("CWE-428")
CWE552<-CWE668$AddChild("CWE-552")
CWE532<-CWE552$AddChild("CWE-532")
CWE534<-CWE532$AddChild("CWE-534")
CWE534<-CWE552$AddChild("CWE-534")
CWE642<-CWE668$AddChild("CWE-642")
CWE472<-CWE642$AddChild("CWE-472")
CWE426<-CWE642$AddChild("CWE-426")
CWE669<-CWE361$AddChild("CWE-669")
CWE434<-CWE669$AddChild("CWE-434")
CWE371<-CWE361$AddChild("CWE-371")
CWE472<-CWE371$AddChild("CWE-472")
CWE642<-CWE371$AddChild("CWE-642")
CWE472<-CWE642$AddChild("CWE-472")
CWE426<-CWE642$AddChild("CWE-426")
CWE384<-CWE361$AddChild("CWE-384")



CWE388<-Soucecode18$AddChild("CWE-388")
# CWE-388 error handling subtree
#CWE<-CWE$AddChild("CWE-")
# CWE_category_388<-Node$new("CWE-388 error handling")
#  CWE754<-CWE_category_388$AddChild("CWE-754 Improper Check for Unusual or Exceptional Conditions")
# print(CWE_category_388)


CWE754<-CWE388$AddChild("CWE-754")
CWE417<-Soucecode18$AddChild("CWE-417")
#CWE-417 channel and path errors subtree
# CWE_category_417<-Node$new("CWE-417 channel and path errors")
# CWE427<-CWE_category_417$AddChild("CWE-427 Uncontrolled Search Path Element")
# CWE428<-CWE_category_417$AddChild("CWE-428 Unquoted Search Path or Element")
# CWE426<-CWE_category_417$AddChild("CWE-426 Untrusted Search Path")
# print(CWE_category_417)

CWE427<-CWE417$AddChild("CWE-427")
CWE428<-CWE417$AddChild("CWE-428")
CWE426<-CWE417$AddChild("CWE-426")


CWE2<-CWE_category$AddChild("CWE-2")
CWE552<-CWE2$AddChild("CWE-552")
CWE532<-CWE552$AddChild("CWE-532")  
CWE534<-CWE532$AddChild("CWE-534")  
CWE534<-CWE552$AddChild("CWE-534")  
CWE435<-CWE2$AddChild("CWE-435")
CWE436<-CWE435$AddChild("CWE-436")
CWE444<-CWE436$AddChild("CWE-444")

#CWE-2 Environment subtree
# CWE_category_2<-Node$new("CWE-2 CWE-2 Environment")
# CWE552<-CWE_category_2$AddChild("CWE-552 Files or Directories Accessible to External Parties")
# CWE532<-CWE552$AddChild("CWE-532 Information Exposure Through Log Files")  
# CWE534<-CWE532$AddChild("CWE-534 Information Exposure Through Debug Log Files")  
# CWE534<-CWE552$AddChild("CWE-534 Information Exposure Through Debug Log Files")  
# CWE435<-CWE_category_2$AddChild("CWE-435 Interaction Error")
# CWE436<-CWE435$AddChild("CWE-436 Interpretation Conflict")
# CWE444<-CWE436$AddChild("CWE-444 Inconsistent Interpretation of HTTP Requests ('HTTP Request Smuggling')")
# print(CWE_category_2)


CWE16<-CWE_category$AddChild("CWE-16")


library(networkD3)
acmeNetwork <- ToDataFrameNetwork(CWE_category, "name")
simpleNetwork(acmeNetwork[-3], fontSize = 12)


useRtreeList <- ToListExplicit(CWE_category, unname = TRUE)
radialNetwork( useRtreeList,width =NULL,  fontSize = 8,fontFamily =   "Arial"  )

